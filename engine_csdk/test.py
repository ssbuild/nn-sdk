# -*- coding: UTF-8 -*-


import tf_csdk
import sys
import platform
sys.path.append(".")

print(tf_csdk.sdk_version())

sys = platform.system()
if sys == "Windows":
    model_dir='D:\\pytorch_model\\bert_ner\\dhcc_model_1.15.0'
    #model_dir = 'D:\\pytorch_model\\bert_ner\\dhcc_model_2.3.0-rc2'
    
    label_file='D:\\pytorch_model\\bert_ner\\labels.txt'
elif sys == "Linux":
    model_dir='/home/tk/finalmodel/bert_ner/dhcc_model_1.15.0'
    model_dir = '/home/tk/finalmodel/bert_ner/dhcc_model_2.3.0-rc2'
    label_file='/home/tk/finalmodel/bert_ner/labels.txt'

conf = {"model_dir":model_dir,"max_seq_length":256,"inner_decode":1,"label_file":label_file,"mode":0}
res = tf_csdk.sdk_new(conf)
print("sdk_new: " + str(res))
input_ids = [[101, 123, 121, 121, 126, 2399, 123, 3299, 122, 124, 3189, 677, 1286, 8024, 6928, 3902, 5705, 1762, 705, 1378, 1277, 7476, 1322, 3333, 123, 122, 127, 1384, 8020, 1266, 776, 2356, 3326, 1921, 5526, 2456, 5029, 1062, 1385, 8021, 1079, 8024, 6158, 2476, 2412, 3862, 8020, 4511, 8024, 125, 122, 2259, 8024, 705, 1378, 1277, 4374, 858, 740, 678, 2411, 3333, 8021, 809, 792, 5305, 2456, 5029, 2339, 4923, 711, 1399, 7745, 6624, 782, 3696, 2355, 122, 123, 121, 121, 121, 1039, 511, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]
input_mask = [[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]

for i in range(1):
    code,result = tf_csdk.sdk_process_ner(res,input_ids,input_mask)
    print(result)
tf_csdk.sdk_delete(res);

